{% extends 'base.html' %}

{% block title %}{{ book.title }}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto p-6">
    <a href="{% url 'final_book_list' book.category.id %}{% if request.GET.grade %}?grade={{ request.GET.grade }}{% endif %}{% if request.GET.subject %}&subject={{ request.GET.subject }}{% endif %}" 
       class="text-blue-600 hover:underline mb-6 inline-block">‚Üê Back to list</a>

    <div class="bg-white shadow-lg rounded-lg overflow-hidden">
        <div class="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-8">
            <h1 class="text-3xl font-bold">{{ book.title }}</h1>
            <p class="text-xl mt-2 opacity-90">by {{ book.author }}</p>
        </div>

        <div class="p-8">
            <div class="grid grid-cols-2 gap-6 text-lg">
                <div><strong>ISBN:</strong> {{ book.isbn }}</div>
                <div><strong>Publisher:</strong> {{ book.publisher }}</div>
                <div><strong>Year:</strong> {{ book.year_of_publication }}</div>
                <div><strong>Centre:</strong> {{ book.centre.name }}</div>
                {% if book.category %}<div><strong>Category:</strong> {{ book.category.name }}</div>{% endif %}
                {% if book.grade %}<div><strong>Grade:</strong> {{ book.grade.name }}</div>{% endif %}
                {% if book.subject %}<div><strong>Subject:</strong> {{ book.subject.name }}</div>{% endif %}
                <div><strong>Status:</strong>
                    {% if book.is_available %}
                    <span class="text-green-600 font-bold">Available</span>
                    {% else %}
                    <span class="text-red-600 font-bold">Currently Borrowed</span>
                    {% endif %}
                </div>
            </div>

            {% if user.is_student and book.is_available %}
            <form method="post" class="mt-8">
                {% csrf_token %}
                <button type="submit" name="action" value="borrow" class="bg-green-600 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:bg-green-700">
                    Borrow This Book
                </button>
                <button type="submit" name="action" value="reserve" class="ml-4 bg-amber-600 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:bg-amber-700">
                    Reserve
                </button>
            </form>
            {% elif user.is_student and not book.is_available %}
            <p class="mt-8 text-red-600 font-semibold">This book is currently borrowed. You can reserve it when returned.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}